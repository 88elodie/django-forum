{% extends 'base.html' %}

{% block title %}Posts{% endblock %}

{% block content %}

{% if messages %}
<section class="messages">
    {% for message in messages %}
    {% if message.tags == 'success' or message.tags == 'info' %}
    <p{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</p>
    {% endif %}
    {% endfor %}
</section>
{% endif %}

<article class="posts-container">
    <h2>posts</h2>

    <section class="posts-grid">
    {% for post in posts %}
    <a href="{% url 'single-post' post.id %}">
    <div>
    <p class="title">{{post.title}}</p>
    <!-- <p class="body"><i>{{post.body|truncatechars:50}}</i></p> -->
    <p class="details">by {{post.author.username}} @ 
        <!-- 'posted' time different formats depending on context -->
        {% now "w" as day %}
        {% now "W" as week %}
        {% now "o" as year %}
        {% if 'minutes' in post.created_at|timesince %}
            <span>{{post.created_at|timesince}} ago</span>
        {% elif post.created_at|date:"w" == day %}
            <span>today, {{post.created_at|time}}</span>
        {% elif post.created_at|date:"w"|add:"1" == day|add:0 %}
            <span>yesterday, {{post.created_at|time}}</span>
        {% elif post.created_at|date:"W" == week %}
            <span>{{post.created_at|date:"l g:i a"}}</span>
        {% elif post.created_at|date:"o" == year %}
            <span>{{post.created_at|date:"F jS \a\t g:i a"}}</span>
        {% else %}
            <span>{{post.created_at|date:"F jS o \a\t g:i a"}}</span>
        {% endif %}
    </p>
    </div>
    <hr>
    </a>
    {% endfor %}
    </section>

</article>

{% endblock %}